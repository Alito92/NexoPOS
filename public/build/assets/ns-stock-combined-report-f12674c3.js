import{h}from"./npm~moment-fbc5633a.js";import{_ as l}from"./currency-47ec5b79.js";import{s as p}from"./select-api-entities-98f90c27.js";import{_ as u}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as b,a6 as a,z as _,A as s,c as y,F as x,ac as f,y as v}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as t}from"./npm~@vue~shared_-82b01912.js";import"./npm~numeral-faf61dd1.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~currency.js-57f74176.js";import"./ns-prompt-popup-be3b5d70.js";import"./npm~@ckeditor~ckeditor5-vue_-b5744b68.js";import"./npm~vue-6a0d7c4c.js";import"./npm~@vue~runtime-dom_-a668b91e.js";import"./npm~@vue~reactivity_-481192b6.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./bootstrap-c5ce18c1.js";import"./npm~lodash-f7a36ac5.js";import"./npm~laravel-echo-7ac8f47a.js";import"./npm~pusher-js-7b18aad5.js";import"./npm~axios-4a70c6fc.js";import"./npm~chart.js-3fed1729.js";import"./npm~rxjs-a7e91008.js";import"./npm~tslib-f3101d7c.js";import"./npm~rx-1641e2f8.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~mathjs-1dff8408.js";import"./npm~@babel~runtime_-34ca84e8.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-15c479db.js";import"./npm~fraction.js-52b397f9.js";import"./npm~typed-function-e88d1f37.js";import"./npm~seedrandom-b246f2f9.js";import"./npm~javascript-natural-sort-11e7fc54.js";import"./npm~escape-latex-404addb9.js";import"./join-array-17927b22.js";const g={props:["storeLogo","storeName"],data(){return{__:l,ns,moment:h,categoriesNames:"",unitsNames:"",categories:[],products:[],units:[],selectedCategories:[],selectedUnits:[],categoryField:{value:[],label:l("Filter by Category")},unitField:{value:[],label:l("Filter by Units")},datePicker:{type:"datetimepicker",name:"date",value:"",validation:"required"}}},methods:{loadReport(){nsHttpClient.post("/api/reports/product-history-combined",{date:this.datePicker.value,categories:this.categoryField.value,units:this.unitField.value}).subscribe({next:o=>{this.products=o},error:o=>{nsSnackBar.error(o.message).subscribe()}})},printSaleReport(){this.$htmlToPaper("combined-report")},async generateReport(){try{const o=await new Promise((n,c)=>{nsHttpClient.get("/api/reports/compute-combined-report").subscribe({next:d=>{n(d)},error:d=>{c(d)}})});nsSnackBar.success(o.message).subscribe()}catch(o){nsSnackBar.error(o.message).subscribe()}},async selectCategories(){try{const o=await p("/api/categories",this.categoryField.label,this.categoryField.value);this.categoryField.value=o.values,this.categoriesNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(l("An error has occured while loading the categories")).subscribe()}},async selectUnits(){try{const o=await p("/api/units",this.unitField.label,this.unitField.value);this.unitField.value=o.values,this.unitsNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(l("An error has occured while loading the units")).subscribe()}}}},k={id:"report-section",class:"px-4"},w={class:"flex -mx-2"},C={class:"px-2 flex -mx-2"},F={class:"px-2"},N={class:"px-2"},S={class:"ns-button"},Q=s("i",{class:"las la-sync-alt text-xl"},null,-1),R={class:"pl-2"},B={class:"px-2"},A={class:"ns-button"},P=s("i",{class:"las la-print text-xl"},null,-1),U={class:"pl-2"},j={class:"px-2 flex -mx-2"},q={class:"px-2"},L={class:"ns-button"},D=s("i",{class:"las la-filter text-xl"},null,-1),H={class:"pl-2"},T={class:"px-2"},V={class:"ns-button"},E=s("i",{class:"las la-filter text-xl"},null,-1),I={class:"pl-2"},M={class:"px-2"},z={class:"ns-button"},G=s("i",{class:"las la-sync-alt"},null,-1),J={class:"pl-2"},K={id:"combined-report"},O={class:"flex w-full mb-4"},W={class:"flex justify-between w-full"},X={class:"text-secondary"},Y=["innerHTML"],Z={class:"pb-1 border-b border-dashed"},$={class:"pb-1 border-b border-dashed"},ss=["src","alt"],es={class:"box bg-box-background"},ts={class:"box-body text-primary"},os={class:"min-w-fit w-full table-auto"},is={class:"text-sm"},rs={class:"font-bold"},ls={class:"border p-2 w-1/3"},cs={class:"border p-2"},ds={class:"hidden md:inline-block"},as={class:"inline-block md:hidden"},_s={class:"border p-2"},ps={class:"hidden md:inline-block"},ms={class:"inline-block md:hidden"},hs={class:"border p-2"},us={class:"hidden md:inline-block"},bs={class:"inline-block md:hidden"},ys={class:"border p-2"},xs={class:"hidden md:inline-block"},fs={class:"inline-block md:hidden"},vs={class:"border p-2"},gs={class:"hidden md:inline-block"},ks={class:"inline-block md:hidden"},ws={class:"text-xs"},Cs={class:"border p-2"},Fs={class:"border p-2"},Ns={class:"border p-2"},Ss={class:"border p-2"},Qs={class:"border p-2"},Rs={class:"border p-2"},Bs={key:0},As={colspan:"6",class:"border p-2 text-center"};function Ps(o,n,c,d,e,r){const m=b("ns-field");return a(),_("div",k,[s("div",w,[s("div",C,[s("div",F,[y(m,{field:e.datePicker},null,8,["field"])]),s("div",N,[s("div",S,[s("button",{onClick:n[0]||(n[0]=i=>r.loadReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[Q,s("span",R,t(e.__("Load")),1)])])]),s("div",B,[s("div",A,[s("button",{onClick:n[1]||(n[1]=i=>r.printSaleReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[P,s("span",U,t(e.__("Print")),1)])])])]),s("div",j,[s("div",q,[s("div",L,[s("button",{onClick:n[2]||(n[2]=i=>r.selectCategories()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[D,s("span",H,t(e.__("Categories"))+": "+t(e.categoriesNames||e.__("All Categories")),1)])])]),s("div",T,[s("div",V,[s("button",{onClick:n[3]||(n[3]=i=>r.selectUnits()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[E,s("span",I,t(e.__("Units"))+": "+t(e.unitsNames||e.__("All Units")),1)])])]),s("div",M,[s("div",z,[s("button",{onClick:n[4]||(n[4]=i=>r.generateReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[G,s("span",J,t(e.__("Generate Report")),1)])])])])]),s("div",K,[s("div",O,[s("div",W,[s("div",X,[s("ul",null,[s("li",{class:"pb-1 border-b border-dashed",innerHTML:e.__("Date : {date}").replace("{date}",e.moment(e.datePicker.value).format(e.ns.date.format))},null,8,Y),s("li",Z,t(e.__("Document : Combined Products History")),1),s("li",$,t(e.__("By : {user}").replace("{user}",e.ns.user.username)),1)])]),s("div",null,[s("img",{class:"w-24",src:c.storeLogo,alt:c.storeName},null,8,ss)])])]),s("div",es,[s("div",ts,[s("table",os,[s("thead",is,[s("tr",rs,[s("td",ls,t(e.__("Name")),1),s("td",cs,[s("span",ds,t(e.__("Initial Quantity")),1),s("span",as,t(e.__("Ini. Qty")),1)]),s("td",_s,[s("span",ps,t(e.__("Added Quantity")),1),s("span",ms,t(e.__("Add. Qty")),1)]),s("td",hs,[s("span",us,t(e.__("Sold Quantity")),1),s("span",bs,t(e.__("Sold Qty")),1)]),s("td",ys,[s("span",xs,t(e.__("Defective Quantity")),1),s("span",fs,t(e.__("Defec. Qty")),1)]),s("td",vs,[s("span",gs,t(e.__("Final Quantity")),1),s("span",ks,t(e.__("Final Qty")),1)])])]),s("tbody",ws,[(a(!0),_(x,null,f(e.products,i=>(a(),_("tr",{key:i.id},[s("td",Cs,t(i.history_name)+" ("+t(i.unit_name)+")",1),s("td",Fs,t(i.history_initial_quantity),1),s("td",Ns,t(i.history_procured_quantity),1),s("td",Ss,t(i.history_sold_quantity),1),s("td",Qs,t(i.history_defective_quantity),1),s("td",Rs,t(i.history_final_quantity),1)]))),128)),e.products.length===0?(a(),_("tr",Bs,[s("td",As,t(e.__("No data available")),1)])):v("",!0)])])])])])])}const ue=u(g,[["render",Ps]]);export{ue as default};
