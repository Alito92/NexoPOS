import{s as w,bG as k,m as o,u as m,p as a,_ as r,o as e,a as d,f as i,F as y,r as x,e as l,q as p,w as F,j as c,i as _,t as S}from"./bootstrap.3799f74e.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";const T={name:"ns-login",props:["token","user"],data(){return{fields:[],xXsrfToken:null,validation:new w,isSubitting:!1}},mounted(){k([o.get("/api/nexopos/v4/fields/ns.new-password"),o.get("/sanctum/csrf-cookie")]).subscribe(t=>{this.fields=this.validation.createFields(t[0]),this.xXsrfToken=o.response.config.headers["X-XSRF-TOKEN"],setTimeout(()=>m.doAction("ns-login-mounted",this),100)},t=>{a.error(t.message||r("An unexpected error occured."),r("OK"),{duration:0}).subscribe()})},methods:{__:r,submitNewPassword(){if(!this.validation.validateFields(this.fields))return a.error(r("Unable to proceed the form is not valid.")).subscribe();this.validation.disableFields(this.fields),m.applyFilters("ns-new-password-submit",!0)&&(this.isSubitting=!0,o.post(`/auth/new-password/${this.user}/${this.token}`,this.validation.getValue(this.fields),{headers:{"X-XSRF-TOKEN":this.xXsrfToken}}).subscribe(s=>{a.success(s.message).subscribe(),setTimeout(()=>{document.location=s.data.redirectTo},500)},s=>{this.isSubitting=!1,this.validation.enableFields(this.fields),s.data&&this.validation.triggerFieldsErrors(this.fields,s.data),a.error(s.message).subscribe()}))}}},V={class:"bg-white rounded shadow overflow-hidden transition-all duration-100"},X={class:"p-3 -my-2"},B={key:0,class:"py-2 fade-in-entrance anim-duration-300"},C={key:0,class:"flex items-center justify-center py-10"},j={class:"flex justify-between items-center bg-gray-200 p-3"},E=i("div",null,null,-1);function P(t,s,K,O,n,u){const b=c("ns-field"),f=c("ns-spinner"),g=c("ns-button");return e(),d("div",V,[i("div",X,[n.fields.length>0?(e(),d("div",B,[(e(!0),d(y,null,x(n.fields,(h,v)=>(e(),_(b,{key:v,field:h},null,8,["field"]))),128))])):l("",!0)]),n.fields.length===0?(e(),d("div",C,[p(f,{border:"4",size:"16"})])):l("",!0),i("div",j,[i("div",null,[p(g,{onClick:s[0]||(s[0]=h=>u.submitNewPassword()),class:"justify-between",type:"info"},{default:F(()=>[n.isSubitting?(e(),_(f,{key:0,class:"mr-2",size:"6",border:"2"})):l("",!0),i("span",null,S(u.__("Save Password")),1)]),_:1})]),E])])}var H=N(T,[["render",P]]);export{H as default};
