import{h}from"./npm~moment-fbc5633a.js";import{_ as l}from"./currency-d0508508.js";import{s as p}from"./select-api-entities-a9252af5.js";import{_ as u}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as b,a6 as d,z as _,A as s,c as y,F as x,ac as f,y as v}from"./npm~@vue~runtime-core_-c1400cf1.js";import{U as t}from"./npm~@vue~shared_-82b01912.js";import"./npm~numeral-b19ffe25.js";import"./npm~@ckeditor~ckeditor5-build-classic_-5cff4652.js";import"./npm~currency.js-57f74176.js";import"./ns-prompt-popup-ffce8cb2.js";import"./npm~@ckeditor~ckeditor5-vue_-1322dee8.js";import"./npm~vue-d815d99e.js";import"./npm~@vue~runtime-dom_-3cadedeb.js";import"./npm~@vue~reactivity_-46d78a21.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./bootstrap-6c2910d2.js";import"./npm~lodash-f5508214.js";import"./npm~laravel-echo-8b7e2b1d.js";import"./npm~pusher-js-244b366d.js";import"./npm~axios-4a70c6fc.js";import"./npm~chart.js-3fed1729.js";import"./npm~rxjs-a7e91008.js";import"./npm~tslib-f3101d7c.js";import"./npm~rx-812d4a49.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~mathjs-eae2cf2e.js";import"./npm~@babel~runtime_-57eb5ba4.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-3f247aa1.js";import"./npm~fraction.js-324b3911.js";import"./npm~typed-function-4896e4f1.js";import"./npm~seedrandom-852a687d.js";import"./npm~javascript-natural-sort-2161c071.js";import"./npm~escape-latex-137e2782.js";import"./join-array-0da381c4.js";const g={props:["storeLogo","storeName"],data(){return{__:l,ns,moment:h,categoriesNames:"",unitsNames:"",categories:[],products:[],units:[],selectedCategories:[],selectedUnits:[],categoryField:{value:[],label:l("Filter by Category")},unitField:{value:[],label:l("Filter by Units")},datePicker:{type:"datetimepicker",name:"date",value:"",validation:"required"}}},methods:{loadReport(){nsHttpClient.post("/api/reports/product-history-combined",{date:this.datePicker.value,categories:this.categoryField.value,units:this.unitField.value}).subscribe({next:o=>{this.products=o},error:o=>{nsSnackBar.error(o.message).subscribe()}})},printSaleReport(){this.$htmlToPaper("combined-report")},async generateReport(){try{const o=await new Promise((n,c)=>{nsHttpClient.get("/api/reports/compute-combined-report").subscribe({next:a=>{n(a)},error:a=>{c(a)}})});nsSnackBar.success(o.message).subscribe()}catch(o){nsSnackBar.error(o.message).subscribe()}},async selectCategories(){try{const o=await p("/api/categories",this.categoryField.label,this.categoryField.value);this.categoryField.value=o.values,this.categoriesNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(l("An error has occured while loading the categories")).subscribe()}},async selectUnits(){try{const o=await p("/api/units",this.unitField.label,this.unitField.value);this.unitField.value=o.values,this.unitsNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(l("An error has occured while loading the units")).subscribe()}}}},k={id:"report-section",class:"px-4"},w={class:"flex -mx-2"},C={class:"px-2"},F={class:"px-2"},N={class:"ns-button"},S=s("i",{class:"las la-sync-alt text-xl"},null,-1),Q={class:"pl-2"},R={class:"px-2"},B={class:"ns-button"},A=s("i",{class:"las la-print text-xl"},null,-1),P={class:"pl-2"},U={class:"px-2"},j={class:"ns-button"},q=s("i",{class:"las la-filter text-xl"},null,-1),L={class:"pl-2"},D={class:"px-2"},H={class:"ns-button"},T=s("i",{class:"las la-filter text-xl"},null,-1),V={class:"pl-2"},E={class:"px-2"},I={class:"ns-button"},M=s("i",{class:"las la-sync-alt"},null,-1),z={class:"pl-2"},G={id:"combined-report"},J={class:"flex w-full mb-4"},K={class:"flex justify-between w-full"},O={class:"text-secondary"},W=["innerHTML"],X={class:"pb-1 border-b border-dashed"},Y={class:"pb-1 border-b border-dashed"},Z=["src","alt"],$={class:"box bg-box-background"},ss={class:"box-body text-primary"},es={class:"min-w-fit w-full table-auto"},ts={class:"text-sm"},os={class:"font-bold"},is={class:"border p-2 w-1/3"},rs={class:"border p-2"},ls={class:"hidden md:inline-block"},cs={class:"inline-block md:hidden"},as={class:"border p-2"},ds={class:"hidden md:inline-block"},_s={class:"inline-block md:hidden"},ps={class:"border p-2"},ms={class:"hidden md:inline-block"},hs={class:"inline-block md:hidden"},us={class:"border p-2"},bs={class:"hidden md:inline-block"},ys={class:"inline-block md:hidden"},xs={class:"border p-2"},fs={class:"hidden md:inline-block"},vs={class:"inline-block md:hidden"},gs={class:"text-xs"},ks={class:"border p-2"},ws={class:"border p-2"},Cs={class:"border p-2"},Fs={class:"border p-2"},Ns={class:"border p-2"},Ss={class:"border p-2"},Qs={key:0},Rs={colspan:"6",class:"border p-2 text-center"};function Bs(o,n,c,a,e,r){const m=b("ns-field");return d(),_("div",k,[s("div",w,[s("div",C,[y(m,{field:e.datePicker},null,8,["field"])]),s("div",F,[s("div",N,[s("button",{onClick:n[0]||(n[0]=i=>r.loadReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[S,s("span",Q,t(e.__("Load")),1)])])]),s("div",R,[s("div",B,[s("button",{onClick:n[1]||(n[1]=i=>r.printSaleReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[A,s("span",P,t(e.__("Print")),1)])])]),s("div",U,[s("div",j,[s("button",{onClick:n[2]||(n[2]=i=>r.selectCategories()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[q,s("span",L,t(e.__("Categories"))+": "+t(e.categoriesNames||e.__("All Categories")),1)])])]),s("div",D,[s("div",H,[s("button",{onClick:n[3]||(n[3]=i=>r.selectUnits()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[T,s("span",V,t(e.__("Units"))+": "+t(e.unitsNames||e.__("All Units")),1)])])]),s("div",E,[s("div",I,[s("button",{onClick:n[4]||(n[4]=i=>r.generateReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[M,s("span",z,t(e.__("Generate Report")),1)])])])]),s("div",G,[s("div",J,[s("div",K,[s("div",O,[s("ul",null,[s("li",{class:"pb-1 border-b border-dashed",innerHTML:e.__("Date : {date}").replace("{date}",e.moment(e.datePicker.value).format(e.ns.date.format))},null,8,W),s("li",X,t(e.__("Document : Combined Products History")),1),s("li",Y,t(e.__("By : {user}").replace("{user}",e.ns.user.username)),1)])]),s("div",null,[s("img",{class:"w-24",src:c.storeLogo,alt:c.storeName},null,8,Z)])])]),s("div",$,[s("div",ss,[s("table",es,[s("thead",ts,[s("tr",os,[s("td",is,t(e.__("Name")),1),s("td",rs,[s("span",ls,t(e.__("Initial Quantity")),1),s("span",cs,t(e.__("Ini. Qty")),1)]),s("td",as,[s("span",ds,t(e.__("Added Quantity")),1),s("span",_s,t(e.__("Add. Qty")),1)]),s("td",ps,[s("span",ms,t(e.__("Sold Quantity")),1),s("span",hs,t(e.__("Sold Qty")),1)]),s("td",us,[s("span",bs,t(e.__("Defective Quantity")),1),s("span",ys,t(e.__("Defec. Qty")),1)]),s("td",xs,[s("span",fs,t(e.__("Final Quantity")),1),s("span",vs,t(e.__("Final Qty")),1)])])]),s("tbody",gs,[(d(!0),_(x,null,f(e.products,i=>(d(),_("tr",{key:i.id},[s("td",ks,t(i.history_name)+" ("+t(i.unit_name)+")",1),s("td",ws,t(i.history_initial_quantity),1),s("td",Cs,t(i.history_procured_quantity),1),s("td",Fs,t(i.history_sold_quantity),1),s("td",Ns,t(i.history_defective_quantity),1),s("td",Ss,t(i.history_final_quantity),1)]))),128)),e.products.length===0?(d(),_("tr",Qs,[s("td",Rs,t(e.__("No data available")),1)])):v("",!0)])])])])])])}const me=u(g,[["render",Bs]]);export{me as default};
