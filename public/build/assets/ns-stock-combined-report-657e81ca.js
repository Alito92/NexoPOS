import{h}from"./npm~moment-fbc5633a.js";import{_ as r}from"./currency-d0508508.js";import{s as _}from"./select-api-entities-a9252af5.js";import{_ as m}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as u,a6 as c,z as d,A as s,c as b,F as y,ac as f,y as x}from"./npm~@vue~runtime-core_-c1400cf1.js";import{U as e}from"./npm~@vue~shared_-82b01912.js";import"./npm~numeral-b19ffe25.js";import"./npm~@ckeditor~ckeditor5-build-classic_-5cff4652.js";import"./npm~currency.js-57f74176.js";import"./ns-prompt-popup-ffce8cb2.js";import"./npm~@ckeditor~ckeditor5-vue_-1322dee8.js";import"./npm~vue-d815d99e.js";import"./npm~@vue~runtime-dom_-3cadedeb.js";import"./npm~@vue~reactivity_-46d78a21.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./bootstrap-6c2910d2.js";import"./npm~lodash-f5508214.js";import"./npm~laravel-echo-8b7e2b1d.js";import"./npm~pusher-js-244b366d.js";import"./npm~axios-4a70c6fc.js";import"./npm~chart.js-3fed1729.js";import"./npm~rxjs-a7e91008.js";import"./npm~tslib-f3101d7c.js";import"./npm~rx-812d4a49.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~mathjs-eae2cf2e.js";import"./npm~@babel~runtime_-57eb5ba4.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-3f247aa1.js";import"./npm~fraction.js-324b3911.js";import"./npm~typed-function-4896e4f1.js";import"./npm~seedrandom-852a687d.js";import"./npm~javascript-natural-sort-2161c071.js";import"./npm~escape-latex-137e2782.js";import"./join-array-0da381c4.js";const v={props:["storeLogo","storeName"],data(){return{__:r,ns,moment:h,categoriesNames:"",unitsNames:"",categories:[],products:[],units:[],selectedCategories:[],selectedUnits:[],categoryField:{value:[],label:r("Filter by Category")},unitField:{value:[],label:r("Filter by Units")},datePicker:{type:"datetimepicker",name:"date",value:"",validation:"required"}}},methods:{loadReport(){nsHttpClient.post("/api/reports/product-history-combined",{date:this.datePicker.value,categories:this.categoryField.value,units:this.unitField.value}).subscribe({next:o=>{this.products=o},error:o=>{nsSnackBar.error(o.message).subscribe()}})},printSaleReport(){this.$htmlToPaper("combined-report")},async selectCategories(){try{const o=await _("/api/categories",this.categoryField.label,this.categoryField.value);this.categoryField.value=o.values,this.categoriesNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(r("An error has occured while loading the categories")).subscribe()}},async selectUnits(){try{const o=await _("/api/units",this.unitField.label,this.unitField.value);this.unitField.value=o.values,this.unitsNames=o.labels,this.loadReport()}catch(o){if(o!==!1)return nsSnackBar.error(r("An error has occured while loading the units")).subscribe()}}}},g={id:"report-section",class:"px-4"},k={class:"flex -mx-2"},w={class:"px-2"},F={class:"px-2"},C={class:"ns-button"},N=s("i",{class:"las la-sync-alt text-xl"},null,-1),Q={class:"pl-2"},S={class:"px-2"},A={class:"ns-button"},B=s("i",{class:"las la-print text-xl"},null,-1),P={class:"pl-2"},R={class:"px-2"},U={class:"ns-button"},q=s("i",{class:"las la-filter text-xl"},null,-1),L={class:"pl-2"},j={class:"px-2"},D={class:"ns-button"},H=s("i",{class:"las la-filter text-xl"},null,-1),T={class:"pl-2"},V={id:"combined-report"},E={class:"flex w-full mb-4"},I={class:"flex justify-between w-full"},M={class:"text-secondary"},z=["innerHTML"],G={class:"pb-1 border-b border-dashed"},J={class:"pb-1 border-b border-dashed"},K=["src","alt"],O={class:"box bg-box-background"},W={class:"box-body text-primary"},X={class:"min-w-fit w-full table-auto"},Y={class:"text-sm"},Z={class:"font-bold"},$={class:"border p-2 w-1/3"},ss={class:"border p-2"},ts={class:"hidden md:inline-block"},es={class:"inline-block md:hidden"},os={class:"border p-2"},is={class:"hidden md:inline-block"},rs={class:"inline-block md:hidden"},ls={class:"border p-2"},cs={class:"hidden md:inline-block"},ds={class:"inline-block md:hidden"},as={class:"border p-2"},_s={class:"hidden md:inline-block"},ps={class:"inline-block md:hidden"},hs={class:"border p-2"},ms={class:"hidden md:inline-block"},us={class:"inline-block md:hidden"},bs={class:"text-xs"},ys={class:"border p-2"},fs={class:"border p-2"},xs={class:"border p-2"},vs={class:"border p-2"},gs={class:"border p-2"},ks={class:"border p-2"},ws={key:0},Fs={colspan:"6",class:"border p-2 text-center"};function Cs(o,n,a,Ns,t,l){const p=u("ns-field");return c(),d("div",g,[s("div",k,[s("div",w,[b(p,{field:t.datePicker},null,8,["field"])]),s("div",F,[s("div",C,[s("button",{onClick:n[0]||(n[0]=i=>l.loadReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[N,s("span",Q,e(t.__("Load")),1)])])]),s("div",S,[s("div",A,[s("button",{onClick:n[1]||(n[1]=i=>l.printSaleReport()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[B,s("span",P,e(t.__("Print")),1)])])]),s("div",R,[s("div",U,[s("button",{onClick:n[2]||(n[2]=i=>l.selectCategories()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[q,s("span",L,e(t.__("Categories"))+": "+e(t.categoriesNames||t.__("All Categories")),1)])])]),s("div",j,[s("div",D,[s("button",{onClick:n[3]||(n[3]=i=>l.selectUnits()),class:"rounded flex justify-between shadow py-1 items-center text-primary px-2"},[H,s("span",T,e(t.__("Units"))+": "+e(t.unitsNames||t.__("All Units")),1)])])])]),s("div",V,[s("div",E,[s("div",I,[s("div",M,[s("ul",null,[s("li",{class:"pb-1 border-b border-dashed",innerHTML:t.__("Date : {date}").replace("{date}",t.moment(t.datePicker.value).format(t.ns.date.format))},null,8,z),s("li",G,e(t.__("Document : Combined Products History")),1),s("li",J,e(t.__("By : {user}").replace("{user}",t.ns.user.username)),1)])]),s("div",null,[s("img",{class:"w-24",src:a.storeLogo,alt:a.storeName},null,8,K)])])]),s("div",O,[s("div",W,[s("table",X,[s("thead",Y,[s("tr",Z,[s("td",$,e(t.__("Name")),1),s("td",ss,[s("span",ts,e(t.__("Initial Quantity")),1),s("span",es,e(t.__("Ini. Qty")),1)]),s("td",os,[s("span",is,e(t.__("Added Quantity")),1),s("span",rs,e(t.__("Add. Qty")),1)]),s("td",ls,[s("span",cs,e(t.__("Sold Quantity")),1),s("span",ds,e(t.__("Sold Qty")),1)]),s("td",as,[s("span",_s,e(t.__("Defective Quantity")),1),s("span",ps,e(t.__("Defec. Qty")),1)]),s("td",hs,[s("span",ms,e(t.__("Final Quantity")),1),s("span",us,e(t.__("Final Qty")),1)])])]),s("tbody",bs,[(c(!0),d(y,null,f(t.products,i=>(c(),d("tr",{key:i.id},[s("td",ys,e(i.history_name)+" ("+e(i.unit_name)+")",1),s("td",fs,e(i.history_initial_quantity),1),s("td",xs,e(i.history_procured_quantity),1),s("td",vs,e(i.history_sold_quantity),1),s("td",gs,e(i.history_defective_quantity),1),s("td",ks,e(i.history_final_quantity),1)]))),128)),t.products.length===0?(c(),d("tr",ws,[s("td",Fs,e(t.__("No data available")),1)])):x("",!0)])])])])])])}const dt=m(v,[["render",Cs]]);export{dt as default};
