import{n as C,b as P,p as F,e as T,P as $}from"./bootstrap-d4a928b9.js";import{n as j}from"./ns-prompt-popup-7de25ed6.js";import{_,n as S}from"./currency-47ec5b79.js";import{_ as g}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as v,a6 as d,z as i,A as s,H as h,y as O,c as u,F as y,ac as w,ax as x,az as V}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as n}from"./npm~@vue~shared_-82b01912.js";import{m as A,w as L}from"./npm~@vue~runtime-dom_-a668b91e.js";import"./npm~lodash-f7a36ac5.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~laravel-echo-7ac8f47a.js";import"./npm~pusher-js-7b18aad5.js";import"./npm~axios-4a70c6fc.js";import"./npm~chart.js-3fed1729.js";import"./npm~rxjs-a7e91008.js";import"./npm~tslib-f3101d7c.js";import"./npm~moment-fbc5633a.js";import"./npm~vue-6a0d7c4c.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./npm~@vue~reactivity_-481192b6.js";import"./npm~rx-1641e2f8.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~mathjs-1dff8408.js";import"./npm~@babel~runtime_-34ca84e8.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-15c479db.js";import"./npm~fraction.js-52b397f9.js";import"./npm~typed-function-e88d1f37.js";import"./npm~seedrandom-b246f2f9.js";import"./npm~javascript-natural-sort-11e7fc54.js";import"./npm~escape-latex-404addb9.js";import"./npm~numeral-faf61dd1.js";import"./npm~currency.js-57f74176.js";import"./npm~@ckeditor~ckeditor5-vue_-b5744b68.js";const N={data(){return{products:[],isLoading:!1}},props:["popup"],computed:{order(){return this.popup.params.order}},mounted(){this.loadProducts()},methods:{__:_,nsCurrency:S,close(){this.popup.params.reject(!1),this.popup.close()},loadProducts(){this.isLoading=!0;const r=this.popup.params.order.id;C.get(`/api/orders/${r}/products`).subscribe(e=>{this.isLoading=!1,this.products=e})},openOrder(){this.popup.close(),this.popup.params.resolve(this.order)}}},U={class:"shadow-lg ns-box w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},B={class:"p-2 flex justify-between text-primary items-center border-b ns-box-header"},H={class:"font-semibold"},D={key:0},z={class:"flex-auto p-2 overflow-y-auto ns-box-body"},K={key:0,class:"flex-auto relative"},q={class:"h-full w-full flex items-center justify-center"},E={class:"flex-col border-b border-info-primary py-2"},M={class:"title font-semibold text-primary flex justify-between"},R={class:"text-sm text-primary"},Y={class:"flex justify-end p-2 border-t ns-box-footer"},G={class:"px-1"},I={class:"-mx-2 flex"},J={class:"px-1"},Q={class:"px-1"};function W(r,e,p,b,a,t){const l=v("ns-close-button"),c=v("ns-spinner"),m=v("ns-button");return d(),i("div",U,[s("div",B,[s("h3",H,[h(n(t.__("Products"))+" â€” "+n(t.order.code)+" ",1),t.order.title?(d(),i("span",D,"("+n(t.order.title)+")",1)):O("",!0)]),s("div",null,[u(l,{onClick:e[0]||(e[0]=f=>t.close())})])]),s("div",z,[a.isLoading?(d(),i("div",K,[s("div",q,[u(c)])])):O("",!0),a.isLoading?O("",!0):(d(!0),i(y,{key:1},w(a.products,f=>(d(),i("div",{class:"item",key:f.id},[s("div",E,[s("div",M,[s("span",null,n(f.name)+" (x"+n(f.quantity)+")",1),s("span",null,n(t.nsCurrency(r.price)),1)]),s("div",R,[s("ul",null,[s("li",null,n(t.__("Unit"))+" : "+n(f.unit.name),1)])])])]))),128))]),s("div",Y,[s("div",G,[s("div",I,[s("div",J,[u(m,{onClick:e[1]||(e[1]=f=>t.openOrder()),type:"info"},{default:x(()=>[h(n(t.__("Open")),1)]),_:1})]),s("div",Q,[u(m,{onClick:e[2]||(e[2]=f=>t.close()),type:"error"},{default:x(()=>[h(n(t.__("Close")),1)]),_:1})])])])])])}const X=g(N,[["render",W]]),Z={props:["orders"],data(){return{searchField:"",columns:{rightColumn:[],leftColumn:[]}}},watch:{orders(){P.doAction("ns-pos-pending-orders-refreshed",this.orders)}},mounted(){this.columns.leftColumn=P.applyFilters("ns-pending-orders-left-column",[{label:_("Code"),value:r=>r.code},{label:_("Cashier"),value:r=>r.user_username},{label:_("Total"),value:r=>r.total},{label:_("Tendered"),value:r=>r.tendered}]),this.columns.rightColumn=P.applyFilters("ns-pending-orders-right-column",[{label:_("Customer"),value:r=>`${r.customer_first_name} ${r.customer_last_name}`},{label:_("Date"),value:r=>r.created_at},{label:_("Type"),value:r=>r.type}])},name:"ns-pos-pending-order",methods:{__:_,previewOrder(r){this.$emit("previewOrder",r)},proceedOpenOrder(r){this.$emit("proceedOpenOrder",r)},searchOrder(){this.$emit("searchOrder",this.searchField)},printOrder(r){this.$emit("printOrder",r)}}},ee={class:"flex flex-auto flex-col overflow-hidden"},se={class:"p-1"},re={class:"flex rounded border-2 input-group info"},te=s("i",{class:"las la-search"},null,-1),oe={class:"mr-1 hidden md:visible"},ne={class:"overflow-y-auto flex flex-auto"},le={class:"flex p-2 flex-auto flex-col overflow-y-auto"},de=["data-order-id"],ie={class:"text-primary"},pe={class:"px-2"},ae={class:"flex flex-wrap -mx-4"},ce={class:"w-full md:w-1/2 px-2"},ue={class:"w-full md:w-1/2 px-2"},_e={class:"flex justify-end w-full mt-2"},me={class:"flex rounded-lg overflow-hidden ns-buttons"},fe=["onClick"],he=s("i",{class:"las la-lock-open"},null,-1),ve=["onClick"],xe=s("i",{class:"las la-eye"},null,-1),be=["onClick"],Oe=s("i",{class:"las la-print"},null,-1),ye={key:0,class:"h-full v-full items-center justify-center flex"},we={class:"text-semibold text-primary"};function ge(r,e,p,b,a,t){return d(),i("div",ee,[s("div",se,[s("div",re,[V(s("input",{onKeyup:e[0]||(e[0]=L(l=>t.searchOrder(),["enter"])),"onUpdate:modelValue":e[1]||(e[1]=l=>a.searchField=l),type:"text",class:"p-2 outline-none flex-auto"},null,544),[[A,a.searchField]]),s("button",{onClick:e[2]||(e[2]=l=>t.searchOrder()),class:"w-16 md:w-24"},[te,s("span",oe,n(t.__("Search")),1)])])]),s("div",ne,[s("div",le,[(d(!0),i(y,null,w(p.orders,l=>(d(),i("div",{"data-order-id":l.id,class:"border-b ns-box-body w-full py-2",key:l.id},[s("h3",ie,n(l.title||"Untitled Order"),1),s("div",pe,[s("div",ae,[s("div",ce,[(d(!0),i(y,null,w(a.columns.leftColumn,(c,m)=>(d(),i("p",{key:m,class:"text-sm text-primary"},[s("strong",null,n(c.label),1),h(" : "+n(c.value(l)),1)]))),128))]),s("div",ue,[(d(!0),i(y,null,w(a.columns.rightColumn,(c,m)=>(d(),i("p",{key:m,class:"text-sm text-primary"},[s("strong",null,n(c.label),1),h(" : "+n(c.value(l)),1)]))),128))])])]),s("div",_e,[s("div",me,[s("button",{onClick:c=>t.proceedOpenOrder(l),class:"info outline-none px-2 py-1"},[he,h(" "+n(t.__("Open")),1)],8,fe),s("button",{onClick:c=>t.previewOrder(l),class:"success outline-none px-2 py-1"},[xe,h(" "+n(t.__("Products")),1)],8,ve),s("button",{onClick:c=>t.printOrder(l),class:"warning outline-none px-2 py-1"},[Oe,h(" "+n(t.__("Print")),1)],8,be)])])],8,de))),128)),p.orders.length===0?(d(),i("div",ye,[s("h3",we,n(t.__("Nothing to display...")),1)])):O("",!0)])])])}const Pe=g(Z,[["render",ge]]),Ce={props:["popup"],components:{nsPosPendingOrders:Pe},methods:{__:_,popupResolver:F,popupCloser:T,searchOrder(r){C.get(`/api/crud/${this.active}?search=${r}`).subscribe(e=>{this.orders=e.data})},setActiveTab(r){this.active=r,this.loadOrderFromType(r)},openOrder(r){POS.loadOrder(r.id),this.popup.close()},loadOrderFromType(r){C.get(`/api/crud/${r}`).subscribe(e=>{this.orders=e.data})},previewOrder(r){new Promise((p,b)=>{Popup.show(X,{order:r,resolve:p,reject:b})}).then(p=>{this.proceedOpenOrder(r)},p=>p)},printOrder(r){POS.print.process(r.id,"sale")},proceedOpenOrder(r){if(POS.products.getValue().length>0)return Popup.show(j,{title:"Confirm Your Action",message:"The cart is not empty. Opening an order will clear your cart would you proceed ?",onAction:p=>{p&&this.openOrder(r)}});this.openOrder(r)}},data(){return{active:"ns.hold-orders",searchField:"",orders:[]}},mounted(){this.loadOrderFromType(this.active)}},ke={class:"shadow-lg ns-box w-6/7-screen md:w-3/5-screen lg:w-2/5-screen h-6/7-screen flex flex-col overflow-hidden"},Fe={class:"p-2 flex justify-between text-primary items-center ns-box-header border-b"},Te={class:"font-semibold"},$e={class:"p-2 flex overflow-hidden flex-auto ns-box-body"},je={class:"p-2 flex justify-between ns-box-footer border-t"},Se=s("div",null,null,-1);function Ve(r,e,p,b,a,t){const l=v("ns-close-button"),c=v("ns-pos-pending-orders"),m=v("ns-tabs-item"),f=v("ns-tabs"),k=v("ns-button");return d(),i("div",ke,[s("div",Fe,[s("h3",Te,n(t.__("Orders")),1),s("div",null,[u(l,{onClick:e[0]||(e[0]=o=>p.popup.close())})])]),s("div",$e,[u(f,{active:a.active,onChangeTab:e[13]||(e[13]=o=>t.setActiveTab(o))},{default:x(()=>[u(m,{identifier:"ns.hold-orders",label:t.__("On Hold"),padding:"p-0",class:"flex flex-col overflow-hidden"},{default:x(()=>[u(c,{orders:a.orders,onSearchOrder:e[1]||(e[1]=o=>t.searchOrder(o)),onPreviewOrder:e[2]||(e[2]=o=>t.previewOrder(o)),onPrintOrder:e[3]||(e[3]=o=>t.printOrder(o)),onProceedOpenOrder:e[4]||(e[4]=o=>t.proceedOpenOrder(o))},null,8,["orders"])]),_:1},8,["label"]),u(m,{identifier:"ns.unpaid-orders",label:t.__("Unpaid"),padding:"p-0",class:"flex flex-col overflow-hidden"},{default:x(()=>[u(c,{orders:a.orders,onSearchOrder:e[5]||(e[5]=o=>t.searchOrder(o)),onPreviewOrder:e[6]||(e[6]=o=>t.previewOrder(o)),onPrintOrder:e[7]||(e[7]=o=>t.printOrder(o)),onProceedOpenOrder:e[8]||(e[8]=o=>t.proceedOpenOrder(o))},null,8,["orders"])]),_:1},8,["label"]),u(m,{identifier:"ns.partially-paid-orders",label:t.__("Partially Paid"),padding:"p-0",class:"flex flex-col overflow-hidden"},{default:x(()=>[u(c,{orders:a.orders,onSearchOrder:e[9]||(e[9]=o=>t.searchOrder(o)),onPreviewOrder:e[10]||(e[10]=o=>t.previewOrder(o)),onPrintOrder:e[11]||(e[11]=o=>t.printOrder(o)),onProceedOpenOrder:e[12]||(e[12]=o=>t.proceedOpenOrder(o))},null,8,["orders"])]),_:1},8,["label"])]),_:1},8,["active"])]),s("div",je,[Se,s("div",null,[u(k,{onClick:e[14]||(e[14]=o=>p.popup.close()),type:"info"},{default:x(()=>[h(n(t.__("Close")),1)]),_:1})])])])}const Ae=g(Ce,[["render",Ve]]),Le={name:"ns-pos-pending-orders-button",methods:{__:_,openPendingOrdersPopup(){$.show(Ae)}}},Ne={class:"ns-button default"},Ue=s("i",{class:"mr-1 text-xl lar la-hand-pointer"},null,-1);function Be(r,e,p,b,a,t){return d(),i("div",Ne,[s("button",{onClick:e[0]||(e[0]=l=>t.openPendingOrdersPopup()),class:"rounded shadow flex-shrink-0 h-12 flex items-center px-2 py-1 text-sm"},[Ue,s("span",null,n(t.__("Orders")),1)])])}const xs=g(Le,[["render",Be]]);export{xs as default};
