import{F as w,f as F,b as l,c as p,n as u}from"./bootstrap.ce8e0264.js";import{_ as o}from"./lang.2d0006f0.js";import{w as S}from"./runtime-dom.esm-bundler.672daa05.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import{b1 as s,aA as r,aB as t,K as V,b6 as X,az as d,x as f,ao as _,br as g,b8 as m,ay as v,aF as B}from"./runtime-core.esm-bundler.d70d6a40.js";const K={name:"ns-login",props:["showRecoveryLink"],data(){return{fields:[],xXsrfToken:null,validation:new w,isSubitting:!1}},mounted(){F({login:l.get("/api/nexopos/v4/fields/ns.login"),csrf:l.get("/sanctum/csrf-cookie")}).subscribe({next:i=>{this.fields=this.validation.createFields(i.login),this.xXsrfToken=l.response.config.headers["X-XSRF-TOKEN"],setTimeout(()=>p.doAction("ns-login-mounted",this),100)},error:i=>{u.error(i.message||o("An unexpected error occured."),o("OK"),{duration:0}).subscribe()}})},methods:{__:o,signIn(){if(!this.validation.validateFields(this.fields))return u.error(o("Unable to proceed the form is not valid.")).subscribe();this.validation.disableFields(this.fields),p.applyFilters("ns-login-submit",!0)&&(this.isSubitting=!0,l.post("/auth/sign-in",this.validation.getValue(this.fields),{headers:{"X-XSRF-TOKEN":this.xXsrfToken}}).subscribe({next:e=>{document.location=e.data.redirectTo},error:e=>{this.isSubitting=!1,this.validation.enableFields(this.fields),e.data&&this.validation.triggerFieldsErrors(this.fields,e.data),u.error(e.message||o("An unexpected error occured.")).subscribe()}}))}}},N={class:"ns-box rounded shadow overflow-hidden transition-all duration-100"},C={class:"ns-box-body"},R={class:"p-3 -my-2"},j={key:0,class:"flex items-center justify-center py-10"},A={key:1,class:"flex w-full items-center justify-center py-4"},E={href:"/password-lost",class:"hover:underline text-blue-600 text-sm"},I={class:"flex justify-between items-center border-t ns-box-footer p-3"};function L(i,e,y,z,a,n){const x=m("ns-field"),h=m("ns-spinner"),b=m("ns-button");return s(),r("div",N,[t("div",C,[t("div",R,[a.fields.length>0?(s(),r("div",{key:0,class:"py-2 fade-in-entrance anim-duration-300",onKeyup:e[0]||(e[0]=S(c=>n.signIn(),["enter"]))},[(s(!0),r(V,null,X(a.fields,(c,k)=>(s(),v(x,{key:k,field:c},null,8,["field"]))),128))],32)):d("",!0)]),a.fields.length===0?(s(),r("div",j,[f(h,{border:"4",size:"16"})])):d("",!0),y.showRecoveryLink?(s(),r("div",A,[t("a",E,_(n.__("Password Forgotten ?")),1)])):d("",!0)]),t("div",I,[t("div",null,[f(b,{onClick:e[1]||(e[1]=c=>n.signIn()),class:"justify-between",type:"info"},{default:g(()=>[a.isSubitting?(s(),v(h,{key:0,class:"mr-2",size:"6",border:"2"})):d("",!0),t("span",null,_(n.__("Sign In")),1)]),_:1})]),t("div",null,[f(b,{link:!0,href:"/sign-up",type:"success"},{default:g(()=>[B(_(n.__("Register")),1)]),_:1})])])])}var U=T(K,[["render",L]]);export{U as default};
