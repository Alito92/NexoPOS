import{_ as p,s as m,m as l,p as u}from"./bootstrap.4fc50695.js";import{e as d,f as h}from"./components.e6ff6fc8.js";import{n as k}from"./ns-select-popup.c6b15ec9.js";import{n as R}from"./ns-paginate.01fa3ad3.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./ns-notice.3d1887a3.js";import"./ns-pos-confirm-popup.04ed5413.js";import"./ns-numpad-plus.89338cd1.js";import"./ns-prompt-popup.38fbac9c.js";import"./ns-alert-popup.e97ff427.js";import"./ns-pos-loading-popup.c4bd0a89.js";const P={name:"ns-low-stock-report",mounted(){this.reportType=this.options[0].value,this.loadRelevantReport()},components:{nsDatepicker:d,nsDateTimePicker:h,nsPaginate:R},data(){return{products:[],options:[{label:p("Stock Report"),value:"stock_report"},{label:p("Low Stock Report"),value:"low_stock"}],stockReportResult:{},reportType:"",reportTypeName:"",validation:new m}},watch:{reportType(){const t=this.options.filter(e=>e.value===this.reportType);t.length>0?this.reportTypeName=t[0].label:this.reportTypeName=p("N/A")}},methods:{__:p,async selectReport(){try{const t=await new Promise((e,i)=>{Popup.show(k,{label:p("Report Type"),options:this.options,resolve:e,reject:i})});this.reportType=t[0].value,this.loadRelevantReport()}catch{}},loadRelevantReport(){switch(this.reportType){case"stock_report":this.loadStockReport();break;case"low_stock":this.loadReport();break}},printSaleReport(){this.$htmlToPaper("low-stock-report")},loadStockReport(t=null){l.get(t||"/api/nexopos/v4/reports/stock-report").subscribe({next:e=>{this.stockReportResult=e},error:e=>{u.error(e.message).subscribe()}})},totalSum(t,e,i){if(t.data!==void 0){const r=t.data.map(o=>o.unit_quantities).map(o=>{const s=o.map(a=>a[e]*a[i]);return s.length>0?s.reduce((a,c)=>parseFloat(a)+parseFloat(c)):0});if(r.length>0)return r.reduce((o,s)=>parseFloat(o)+parseFloat(s))}return 0},sum(t,e){if(t.data!==void 0){const n=t.data.map(r=>r.unit_quantities).map(r=>{const o=r.map(s=>s[e]);return o.length>0?o.reduce((s,a)=>parseFloat(s)+parseFloat(a)):0});if(n.length>0)return n.reduce((r,o)=>parseFloat(r)+parseFloat(o))}return 0},loadReport(){l.get("/api/nexopos/v4/reports/low-stock").subscribe({next:t=>{this.products=t},error:t=>{u.error(t.message).subscribe()}})}}};export{P as default};
