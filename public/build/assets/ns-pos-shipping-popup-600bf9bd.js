import{F as v,e as x,n as w}from"./bootstrap-4befc3ba.js";import{_ as y}from"./_plugin-vue_export-helper-c27b6911.js";import{ae as u,a6 as n,z as l,A as s,F as m,ac as h,c as b,ax as F,H as S}from"./npm~@vue~runtime-core_-ff0bdc0c.js";import{U as p,z as f}from"./npm~@vue~shared_-82b01912.js";import"./npm~lodash-f7a36ac5.js";import"./npm~@ckeditor~ckeditor5-build-classic_-a8abd726.js";import"./npm~laravel-echo-7ac8f47a.js";import"./npm~pusher-js-7b18aad5.js";import"./npm~axios-4a70c6fc.js";import"./npm~chart.js-3fed1729.js";import"./npm~rxjs-a7e91008.js";import"./npm~tslib-f3101d7c.js";import"./npm~moment-fbc5633a.js";import"./npm~vue-6a0d7c4c.js";import"./npm~@vue~runtime-dom_-a668b91e.js";import"./npm~@vue~reactivity_-481192b6.js";import"./npm~@vue~compiler-dom_-04241bb4.js";import"./npm~@vue~compiler-core_-2a2ce8c7.js";import"./npm~rx-1641e2f8.js";import"./currency-47ec5b79.js";import"./npm~numeral-faf61dd1.js";import"./npm~currency.js-57f74176.js";import"./npm~@wordpress~hooks_-18172e20.js";import"./npm~mathjs-1dff8408.js";import"./npm~@babel~runtime_-34ca84e8.js";import"./npm~decimal.js-d133ee8e.js";import"./npm~complex.js-15c479db.js";import"./npm~fraction.js-52b397f9.js";import"./npm~typed-function-e88d1f37.js";import"./npm~seedrandom-b246f2f9.js";import"./npm~javascript-natural-sort-11e7fc54.js";import"./npm~escape-latex-404addb9.js";const k={name:"ns-pos-shipping-popup",props:["popup"],computed:{activeTabFields(){if(this.tabs!==null){for(let t in this.tabs)if(this.tabs[t].active)return this.tabs[t].fields}return[]},useBillingInfo(){return this.tabs!==null?this.tabs.billing.fields[0].value:new Object},useShippingInfo(){return this.tabs!==null?this.tabs.shipping.fields[0].value:new Object}},unmounted(){this.orderSubscription.unsubscribe()},mounted(){this.orderSubscription=POS.order.subscribe(t=>this.order=t),this.loadForm()},data(){return{tabs:null,orderSubscription:null,order:null,formValidation:new v}},watch:{useBillingInfo(t){t===1&&this.tabs.billing.fields.forEach(e=>{e.name!=="_use_customer_billing"&&(e.value=this.order.customer.billing?this.order.customer.billing[e.name]:e.value)})},useShippingInfo(t){t===1&&this.tabs.shipping.fields.forEach(e=>{e.name!=="_use_customer_shipping"&&(e.value=this.order.customer.shipping?this.order.customer.shipping[e.name]:e.value)})}},methods:{__,resolveIfQueued:x,submitInformations(){const t=this.formValidation.extractForm({tabs:this.tabs});for(let e in t.general)["shipping","shipping_rate"].includes(e)&&(t.general[e]=parseFloat(t.general[e]));this.order={...this.order,...t.general},delete t.general,delete t.shipping._use_customer_shipping,delete t.billing._use_customer_billing,this.order.addresses=t,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup(){this.resolveIfQueued(!1)},toggle(t){for(let e in this.tabs)this.tabs[e].active=!1;this.tabs[t].active=!0},loadForm(){w.get("/api/forms/ns.pos-addresses").subscribe(({tabs:t})=>{for(let e in t)e==="general"?t[e].fields.forEach(o=>{o.value=this.order[o.name]||""}):t[e].fields.forEach(o=>{o.value=this.order.addresses[e]?this.order.addresses[e][o.name]:""});this.tabs=this.formValidation.initializeTabs(t)})}}},C={class:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},V={class:"p-2 border-b ns-box-header flex justify-between items-center"},I={class:"font-bold text-primary"},B={class:"tools"},P=s("i",{class:"las la-times"},null,-1),j=[P],E={class:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},O={id:"tabs-container"},z={class:"header flex",style:{"margin-bottom":"-1px"}},T=["onClick"],N={class:"border ns-tab-item"},Q={class:"px-4"},H={class:"-mx-4 flex flex-wrap"},A={class:"p-2 flex justify-between border-t ns-box-footer"},D=s("div",null,null,-1);function L(t,e,o,R,d,r){const _=u("ns-field"),g=u("ns-button");return n(),l("div",C,[s("div",V,[s("h3",I,p(r.__("Shipping & Billing")),1),s("div",B,[s("button",{onClick:e[0]||(e[0]=i=>r.closePopup()),class:"ns-close-button rounded-full h-8 w-8 border items-center justify-center"},j)])]),s("div",E,[s("div",O,[s("div",z,[(n(!0),l(m,null,h(d.tabs,(i,a)=>(n(),l("div",{key:a,onClick:c=>r.toggle(a),class:f([i.active?"border-b-0 active":"inactive","tab rounded-tl rounded-tr border tab px-3 py-2 text-primary cursor-pointer"]),style:{"margin-right":"-1px"}},p(i.label),11,T))),128))]),s("div",N,[s("div",Q,[s("div",H,[(n(!0),l(m,null,h(r.activeTabFields,(i,a)=>(n(),l("div",{key:a,class:f("p-4 w-full md:w-1/2 lg:w-1/3")},[b(_,{onBlur:c=>d.formValidation.checkField(i),onChange:c=>d.formValidation.checkField(i),field:i},null,8,["onBlur","onChange","field"])]))),128))])])])])]),s("div",A,[D,s("div",null,[b(g,{onClick:e[1]||(e[1]=i=>r.submitInformations()),type:"info"},{default:F(()=>[S(p(r.__("Save")),1)]),_:1})])])])}const we=y(k,[["render",L]]);export{we as default};
