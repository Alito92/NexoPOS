import{_ as d,B as E,A as P,o as s,a as r,f as l,t as _,F as u,r as m,n as A,s as B,q as g,e as f,w as h,j as p,i as b}from"./bootstrap.f2724e83.js";import{_ as v}from"./plugin-vue_export-helper.21dcd24c.js";import"./ns-notice.9f3b0acd.js";import L from"./ns-pos-confirm-popup.e8c513d2.js";import{n as C}from"./currency.cdd08e48.js";const V={name:"ns-expense-selector",data(){return{configurations:[],type:null}},mounted(){this.configurations=this.$popupParams.configurations,this.type=this.$popupParams.type},methods:{__:d,nsCurrency:C,popupResolver:E,popupCloser:P,selectType(e){this.popupResolver(e)}}},$={class:"w-6/7-screen md:w-4/7-screen lg:w-3/7-screen flex flex-col shadow-lg ns-box"},j={class:"ns-box-header p-2 border-b flex justify-between items-center"},F={class:"font-bold text-xl"},N={class:"grid grid-cols-2"},R=["onClick"],S=["src","alt"],q={class:"font-bold"};function z(e,t,a,w,n,c){return s(),r("div",$,[l("div",j,[l("h3",F,_(c.__("Expense Type")),1)]),l("div",N,[(s(!0),r(u,null,m(n.configurations,i=>(s(),r("div",{class:A([n.type===i.identifier?"info":"","h-40 elevation-surface hoverable flex-col flex items-center justify-center cursor-pointer"]),onClick:x=>c.selectType(i),key:i.identifier},[l("img",{src:i.icon,class:"w-20 my-2",alt:i.label},null,8,S),l("h3",q,_(i.label),1)],10,R))),128))])])}var D=v(V,[["render",z]]);const H={props:["expense"],data(){return{handledExpense:{type:void 0},configurations:[],activeTab:"create-customers",selectedConfiguration:{},isLoading:!1,tabs:[],validation:new B}},computed:{},mounted(){this.init()},methods:{__:d,nsCurrency:C,setActiveTab(e){this.activeTab=e},setTabs(){const e=[{label:this.selectedConfiguration.label||d("N/A"),identifier:"general",active:!0,fields:this.selectedConfiguration.fields}];["ns.recurring-expenses","ns.salary-expenses"].includes(this.selectedConfiguration.identifier)&&e.push({label:d("Recurrence"),identifier:"recurrence"}),this.tabs=e},async init(){try{this.handledExpense={type:void 0},this.isLoading=!0,this.configurations=await this.loadConfiguration(),this.expense!==void 0&&(this.handledExpense=this.expense),this.handledExpense.type===void 0&&await this.selectExpenseType(),this.isLoading=!1,this.setTabs()}catch{}},async selectExpenseType(){try{const e=await new Promise((t,a)=>{Popup.show(D,{resolve:t,reject:a,configurations:this.configurations,type:this.handledExpense.type})});e.fields=this.validation.createFields(e.fields),this.selectedConfiguration=e}catch(e){console.log(e)}},confirmTypeChange(){Popup.show(L,{title:d("Change Type"),message:d("By proceeding the current for and all your entries will be cleared. Would you like to proceed?"),onAction:e=>{e&&this.init()}})},loadConfiguration(){return new Promise((e,t)=>{nsHttpClient.get("/api/nexopos/v4/expenses/configurations").subscribe({next:a=>{e(a)},error:a=>{t(a)}})})}}},W={key:0,class:"h-half w-full flex items-center justify-center"},G={key:1},I={class:"ns-button"};function J(e,t,a,w,n,c){const i=p("ns-spinner"),x=p("ns-field"),T=p("ns-tabs-item"),k=p("ns-tabs");return s(),r(u,null,[n.isLoading?(s(),r("div",W,[g(i)])):f("",!0),n.tabs.length>0&&!n.isLoading?(s(),r("div",G,[g(k,{active:n.activeTab,onActive:t[1]||(t[1]=o=>c.setActiveTab(o))},{extra:h(()=>[l("div",I,[l("button",{onClick:t[0]||(t[0]=o=>c.confirmTypeChange()),class:"py-1 px-2 text-sm rounded"},_(c.__("Change Type")),1)])]),default:h(()=>[(s(!0),r(u,null,m(n.tabs,o=>(s(),b(T,{key:o.identifier,identifier:o.identifier,label:o.label},{default:h(()=>[o.fields?(s(!0),r(u,{key:0},m(o.fields,y=>(s(),b(x,{key:y.name,field:y},null,8,["field"]))),128)):f("",!0)]),_:2},1032,["identifier","label"]))),128))]),_:1},8,["active"])])):f("",!0)],64)}var X=v(H,[["render",J]]);export{X as default};
